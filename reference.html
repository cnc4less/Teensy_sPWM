<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by OpenOffice.org - see http://xml.openoffice.org/odf2xhtml for more info.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">Teensy_sPWM Reference</title><meta name="DCTERMS.title" content="Teensy_sPWM Reference" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.creator" content="Brandon Foltz"/><meta name="DCTERMS.issued" content="2012-09-26T12:10:36" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.contributor" content="Brandon Foltz"/><meta name="DCTERMS.modified" content="2012-09-27T11:41:27" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.P1 { font-size:14pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
	.P10 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:bold; }
	.P11 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
	.P12 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; }
	.P13 { font-size:14pt; margin-bottom:0.0835in; margin-top:0in; font-family:Arial; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
	.P14 { font-size:14pt; margin-bottom:0.0835in; margin-top:0in; font-family:Andale Mono; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
	.P16 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; }
	.P17 { font-size:14pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:bold; }
	.P19 { font-size:14pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; color:#000000; letter-spacing:normal; font-style:normal; }
	.P20 { font-size:24pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Times New Roman; writing-mode:page; color:#000000; letter-spacing:normal; font-style:normal; }
	.P3 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
	.P4 { font-size:14pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:bold; }
	.P5 { font-size:12pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; }
	.P6 { font-size:18pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; }
	.P7 { font-size:14pt; font-weight:bold; margin-bottom:0.0835in; margin-top:0.1665in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; }
	.P8 { font-size:14pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:bold; }
	.P9 { font-size:14pt; margin-bottom:0.0835in; margin-top:0in; font-family:Times New Roman; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#000000; letter-spacing:normal; font-style:normal; font-weight:bold; }
	.T1 { font-weight:bold; }
	.T10 { font-family:Times New Roman; font-size:14pt; }
	.T12 { font-family:Times New Roman; font-size:14pt; font-weight:normal; }
	.T15 { font-family:Times New Roman; font-size:14pt; font-weight:normal; }
	.T16 { font-family:Times New Roman; font-size:14pt; }
	.T17 { font-family:Times New Roman; font-size:14pt; font-weight:bold; }
	.T18 { font-size:14pt; font-weight:normal; }
	.T19 { font-size:14pt; font-weight:normal; }
	.T2 { font-weight:bold; }
	.T20 { font-size:14pt; font-weight:normal; }
	.T21 { font-size:14pt; font-weight:bold; }
	.T22 { font-size:14pt; font-weight:bold; }
	.T23 { font-size:14pt; }
	.T3 { color:#000000; font-family:Times New Roman; font-size:10pt; letter-spacing:normal; font-style:normal; font-weight:normal; }
	.T4 { color:#000000; font-family:Times New Roman; font-size:14pt; letter-spacing:normal; font-style:normal; font-weight:normal; }
	.T5 { color:#000000; font-family:Times New Roman; font-size:14pt; letter-spacing:normal; font-style:normal; font-weight:bold; }
	.T6 { color:#000000; font-family:Times New Roman; font-size:14pt; letter-spacing:normal; font-style:normal; font-weight:normal; }
	.T7 { font-family:Times New Roman; }
	.T8 { font-family:Times New Roman; font-size:14pt; }
	.T9 { font-family:Times New Roman; font-size:14pt; font-weight:bold; }
	<!-- ODF styles with no properties representable as CSS -->
	.T14 { }
	</style></head><body dir="ltr" style="max-width:8.5in;margin:0.7874in; margin-top:0.7874in; margin-bottom:0.7874in; margin-left:0.7874in; margin-right:0.7874in; writing-mode:lr-tb; "><h1 class="P20"><a id="a__Teensy_sPWM_Reference"><span/></a>Teensy_sPWM Reference</h1><p class="P19">Version 0.1 (release date TBD)</p><h2 class="P6"><a id="a__Overview"><span/></a>Overview</h2><p class="P1">This is a library for emulating pulse-width modulation on Teensy 2.0 and similar devices.</p><h2 class="P6"><a id="a__How_to_use"><span/></a>How to use</h2><p class="P1">Before doing anything else, you must call <span class="T1">PWM_init(int Hz)</span>, specifying a value for <span class="T1">Hz</span>. This will set up the library and all necessary subsystems, with pulse-width set by the frequency you specify in <span class="T1">Hz</span>.</p><p class="P1">You must have a program loop, in which <span class="T1">PWM_loop()</span> must be called regularly to generate the pulses. It should be called as often as possible, such as in an idle loop.</p><h2 class="P6"><a id="a__Functions"><span/></a>Functions</h2><h3 class="P7"><a id="a__int_PWM_init_unsigned_int_Hz__char_options_"><span/></a>int PWM_init(unsigned int Hz, char options)</h3><p class="P1">Initializes Arduino library so functions like <span class="T1">millis()</span> and <span class="T1">micros()</span> can be used. Initializes variables that associate pin letters and numbers with their respective internal representations. Sets all pins to 0% PWM. Sets the pulse width to the corresponding length as specified by the <span class="T1">Hz</span> parameter. The parameter <span class="T2">options</span><span class="T14"> is used to set various internal operating modes. Valid options are:</span></p><p class="P12"><span class="T22">MAKE_UP_LOST_TIME</span><span class="T19"> – When enabled the system will attempt to make up for delays to power a pin from the last cycle during the next one, and will subtract excess time spent in a previous powered cycle from the next one.</span></p><p class="P12"><span class="T19"/></p><p class="P9">void PWM_loop(void)</p><p class="P12"><span class="T18">This function is responsible for updating pin statuses and pulse regulation. It should be called very often, ideally from a loop that runs infinitely (unless you wish to disable PWM).</span></p><p class="P12"><span class="T18"/></p><p class="P9">int set_pin_PWM(char port, char pin, uint8_t pwmPercent)</p><p class="P3"><span class="T8">Sets the PWM level for a given pin. </span><span class="T9">port</span><span class="T8"> should be a letter between A and F representing the port letters on the Teensy. </span><span class="T9">pin</span><span class="T8"> should be an integer between 0 and 7 </span><span class="T8">representing the respective pin number on a given port. </span><span class="T9">pwmPercent</span><span class="T8"> is the level of PWM and should be an integer between 0 and 100. This function returns </span><span class="T10">1 on success and 0 on failure. The</span><span class="T8"> following line would set pin B3 to PWM level of 75 percent:</span></p><p class="P13">set_pin_PWM('B', 3, 75);</p><p class="P4"> </p><p class="P4">int set_pin_PWM_normalized(char port, char pin, float normPwm)</p><p class="P16"><span class="T15">This function is identical to set_pin_PWM, except for the parameter </span><span class="T17">normPwm</span><span class="T15">. You can pass a floating point value from 0.0 to 1.0 in </span><span class="T17">normPwm</span><span class="T15">, representing values from 0 to 100 percent. </span><span class="T12">This function returns 1 on success and 0 on failure.</span></p><p class="P16"><span class="T12"/></p><p class="P17"><span class="T7">int set_abstract_pin_PWM(uint8_t pin, uint8_t pwmPercent)</span></p><p class="P3"><span class="T8">Sets the PWM level for a given abstractly numbered pin. </span><span class="T9">pin</span><span class="T8"> should be an integer between 0 and the number of pins on your given device, representing the respective pin number of this functions numbering convention (0 starts at upper left and goes down, continues at bottom right upwards, and then inward to the left. TODO: link or include a diagram showing pin numbering for different devices). </span><span class="T9">pwmPercent</span><span class="T8"> is the level of PWM and should be an integer between 0 and 100. This function returns </span><span class="T10">1 on success and 0 on failure.</span><span class="T8"> The following line would set pin B7 to PWM level of 75 percent, as pin B7 is abstract pin number 4:</span></p><p class="P14">set_abstract_pin_PWM(4, 75);</p><p class="P8"> </p><p class="P8">int set_abstract_pin_PWM_normalized(uint8_t pin, float normPwm)</p><p class="P10"><span class="T19">This function is the same as set_abstract_pin_PWM, </span><span class="T15">except for the parameter </span><span class="T16">normPwm</span><span class="T15">. You can pass a floating point value from 0.0 to 1.0 in </span><span class="T16">normPwm</span><span class="T15">, representing values from 0 to 100 percent. </span><span class="T20">This function returns 1 on success and 0 on failure.</span></p><p class="P10"><span class="T20"/></p><p class="P10"><span class="T16">int set_all_abstract_pins_PWM(uint8_t pwmPercent)</span></p><p class="P11"><span class="T16">Sets all pins to the PWM percentage passed in </span><span class="T17">pwmPercent</span><span class="T16">. </span><span class="T21">pwmPercent</span><span class="T23"> is the level of PWM and should be an integer between 0 and 100. This function returns 1 on success and 0 on failure.</span></p><p class="P11"><span class="T23"/></p><p class="P10"><span class="T16">int set_all_abstract_pins_PWM_normalized(float normPwm)</span></p><p class="P11"><span class="T16">Sets all pins to the PWM level passed in </span><span class="T17">normPwm</span><span class="T16">. You can pass a floating point value from 0.0 to 1.0 in </span><span class="T17">normPwm</span><span class="T16">, representing values from 0 to 100 percent. </span><span class="T23">This function returns 1 on success and 0 on failure.</span></p><p class="P11"><span class="T16"/></p><p class="P10"><span class="T16">int set_abstract_pin_range_PWM(int start, int end, uint8_t pwmPercent)</span></p><p class="P11"><span class="T16">Sets all abstract pins in the range starting at </span><span class="T17">start </span><span class="T16">and ending at </span><span class="T17">end</span><span class="T16"> to the PWM level specified in </span><span class="T17">pwmPercent</span><span class="T16">. </span><span class="T21">pwmPercent</span><span class="T23"> is the level of PWM and should be an integer between 0 and 100. This function returns 1 on success and 0 on failure.</span></p><p class="P11"><span class="T23"/></p><p class="P10"><span class="T16">int set_abstract_pin_range_PWM_normalized(int start, int end, float normPwm)</span></p><p class="P5"><span class="T6">Sets all abstract pins in the range starting at </span><span class="T5">start </span><span class="T6">and ending at </span><span class="T5">end</span><span class="T6"> to the PWM level specified in </span><span class="T5">normPwm</span><span class="T6">. You can pass a floating point value from 0.0 to 1.0 in </span><span class="T5">normPwm</span><span class="T6">, representing values from 0 to 100 percent.</span><span class="T4"> This function returns 1 on success and 0 on failure.</span></p><p class="P5"><br/><span class="T3">Last updated 9/27/12</span></p></body></html>
